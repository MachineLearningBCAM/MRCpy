<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example: Use of MRC with different settings &mdash; MRCpy 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example: Use of CMRC with different settings" href="plot_2_example_cmrc.html" />
    <link rel="prev" title="Gallery of examples" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MRCpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">MRCpy Package Contents</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery of examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#basic-examples">Basic Examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Example: Use of MRC with different settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_2_example_cmrc.html">Example: Use of CMRC with different settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_3_example_amrc.html">Example: Use of AMRC (Adaptative MRC) for Online Learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_4_example_dwgcs.html">Example: Use of DWGCS (Double-Weighting General Covariate Shift) for Covariate Shift Adaptation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#further-applications">Further applications</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MRCpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Gallery of examples</a></li>
      <li class="breadcrumb-item active">Example: Use of MRC with different settings</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/plot_1_example_mrc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-plot-1-example-mrc-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="example-use-of-mrc-with-different-settings">
<span id="ex1"></span><span id="sphx-glr-auto-examples-plot-1-example-mrc-py"></span><h1>Example: Use of MRC with different settings<a class="headerlink" href="#example-use-of-mrc-with-different-settings" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>Example of using MRC with some of the common classification datasets with
different losses and feature mappings settings. We load the different datasets
and use 10-Fold Cross-Validation to generate the partitions for train and test.
We separate 1 partition each time for testing and use the others for training.
On each iteration we calculate the classification error as well as the upper
and lower bounds for the error. We also calculate the mean training time.</p>
<p>Note that we set the parameter use_cvx=False. In the case of MRC classifiers
this means that we will use nesterov subgradient optimized approach to
perform the optimization.</p>
<p>You can check a more elaborated example in <a class="reference internal" href="further_examples/plot_3_comparison.html#ex-comp"><span class="std std-ref">Example: Comparison to other methods</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="kn">from</span> <span class="nn">MRCpy</span> <span class="kn">import</span> <span class="n">MRC</span>
<span class="c1"># Import the datasets</span>
<span class="kn">from</span> <span class="nn">MRCpy.datasets</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Data sets</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loaders</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="n">load_mammographic</span><span class="p">,</span>
    <span class="n">load_haberman</span><span class="p">,</span>
    <span class="n">load_indian_liver</span><span class="p">,</span>
    <span class="n">load_diabetes</span><span class="p">,</span>
    <span class="n">load_credit</span><span class="p">,</span>
<span class="p">]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataName</span></a> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mammographic&quot;</span><span class="p">,</span> <span class="s2">&quot;haberman&quot;</span><span class="p">,</span> <span class="s2">&quot;indian_liver&quot;</span><span class="p">,</span> <span class="s2">&quot;diabetes&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">runMRC</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">loss</span><span class="p">):</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="c1"># We fix the random seed to that the stratified kfold performed</span>
    <span class="c1"># is the same through the different executions</span>
    <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Iterate through each of the dataset and fit the MRC classfier.</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">load</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">loaders</span></a><span class="p">):</span>

        <span class="c1"># Loading the dataset</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">load</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique" title="numpy.unique" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unique</span></a><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">clf</span> <span class="o">=</span> <span class="n">MRC</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>
                  <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>
                  <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span>
                  <span class="n">max_iters</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;subgrad&#39;</span><span class="p">)</span>

        <span class="c1"># Generate the partitions of the stratified cross-validation</span>
        <span class="n">n_splits</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span>
            <span class="n">n_splits</span><span class="o">=</span><span class="n">n_splits</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">cvError</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">auxTime</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Paired and stratified cross-validation</span>
        <span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>

            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
            <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">train_index</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

            <span class="c1"># Normalizing the data</span>
            <span class="n">std_scale</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">std_scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
            <span class="n">X_test</span> <span class="o">=</span> <span class="n">std_scale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

            <span class="c1"># Save start time for computing training time</span>
            <span class="n">startTime</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/time.html#time.time" title="time.time" class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"><span class="n">time</span><span class="o">.</span><span class="n">time</span></a><span class="p">()</span>

            <span class="c1"># Train the model and save the upper and lower bounds</span>
            <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">upper</span> <span class="o">+=</span> <span class="n">clf</span><span class="o">.</span><span class="n">get_upper_bound</span><span class="p">()</span>
            <span class="n">lower</span> <span class="o">+=</span> <span class="n">clf</span><span class="o">.</span><span class="n">get_lower_bound</span><span class="p">()</span>

            <span class="c1"># Save the training time</span>
            <span class="n">auxTime</span> <span class="o">+=</span> <a href="https://docs.python.org/3/library/time.html#time.time" title="time.time" class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"><span class="n">time</span><span class="o">.</span><span class="n">time</span></a><span class="p">()</span> <span class="o">-</span> <span class="n">startTime</span>

            <span class="c1"># Predict the class for test instances</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

            <span class="c1"># Calculate the error made by MRC classificator</span>
            <span class="n">cvError</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.average.html#numpy.average" title="numpy.average" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">average</span></a><span class="p">(</span><span class="n">y_pred</span> <span class="o">!=</span> <span class="n">y_test</span><span class="p">))</span>

        <span class="n">res_mean</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.average.html#numpy.average" title="numpy.average" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">average</span></a><span class="p">(</span><span class="n">cvError</span><span class="p">)</span>
        <span class="n">res_std</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.std.html#numpy.std" title="numpy.std" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">std</span></a><span class="p">(</span><span class="n">cvError</span><span class="p">)</span>

        <span class="c1"># Calculating the mean upper and lower bound and training time</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">/</span> <span class="n">n_splits</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">/</span> <span class="n">n_splits</span>
        <span class="n">auxTime</span> <span class="o">=</span> <span class="n">auxTime</span> <span class="o">/</span> <span class="n">n_splits</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">_append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dataName</span></a><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                <span class="s2">&quot;n_samples&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">n</span><span class="p">,</span>
                <span class="s2">&quot;n_attributes&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">d</span><span class="p">,</span>
                <span class="s2">&quot;n_classes&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r</span><span class="p">,</span>
                <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%1.2g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_mean</span> <span class="o">+</span> <span class="s2">&quot; +/- &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%1.2g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_std</span><span class="p">,</span>
                <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%1.2g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">upper</span><span class="p">,</span>
                <span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%1.2g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">lower</span><span class="p">,</span>
                <span class="s2">&quot;avg_train_time (s)&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%1.2g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">auxTime</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span> <span class="o">=</span> <span class="n">runMRC</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="s2">&quot;fourier&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;0-1&quot;</span><span class="p">)</span>
<span class="n">r1</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Using 0-1 loss and fourier feature mapping&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style type="text/css">
</style>
<table id="T_41d03">
  <caption>Using 0-1 loss and fourier feature mapping</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_41d03_level0_col0" class="col_heading level0 col0" >dataset</th>
      <th id="T_41d03_level0_col1" class="col_heading level0 col1" >n_samples</th>
      <th id="T_41d03_level0_col2" class="col_heading level0 col2" >n_attributes</th>
      <th id="T_41d03_level0_col3" class="col_heading level0 col3" >n_classes</th>
      <th id="T_41d03_level0_col4" class="col_heading level0 col4" >error</th>
      <th id="T_41d03_level0_col5" class="col_heading level0 col5" >upper</th>
      <th id="T_41d03_level0_col6" class="col_heading level0 col6" >lower</th>
      <th id="T_41d03_level0_col7" class="col_heading level0 col7" >avg_train_time (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_41d03_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_41d03_row0_col0" class="data row0 col0" >mammographic</td>
      <td id="T_41d03_row0_col1" class="data row0 col1" >961</td>
      <td id="T_41d03_row0_col2" class="data row0 col2" >5</td>
      <td id="T_41d03_row0_col3" class="data row0 col3" >2</td>
      <td id="T_41d03_row0_col4" class="data row0 col4" >0.18 +/- 0.013</td>
      <td id="T_41d03_row0_col5" class="data row0 col5" >0.23</td>
      <td id="T_41d03_row0_col6" class="data row0 col6" >0.21</td>
      <td id="T_41d03_row0_col7" class="data row0 col7" >0.69</td>
    </tr>
    <tr>
      <th id="T_41d03_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_41d03_row1_col0" class="data row1 col0" >haberman</td>
      <td id="T_41d03_row1_col1" class="data row1 col1" >306</td>
      <td id="T_41d03_row1_col2" class="data row1 col2" >3</td>
      <td id="T_41d03_row1_col3" class="data row1 col3" >2</td>
      <td id="T_41d03_row1_col4" class="data row1 col4" >0.27 +/- 0.016</td>
      <td id="T_41d03_row1_col5" class="data row1 col5" >0.26</td>
      <td id="T_41d03_row1_col6" class="data row1 col6" >0.24</td>
      <td id="T_41d03_row1_col7" class="data row1 col7" >0.45</td>
    </tr>
    <tr>
      <th id="T_41d03_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_41d03_row2_col0" class="data row2 col0" >indian_liver</td>
      <td id="T_41d03_row2_col1" class="data row2 col1" >583</td>
      <td id="T_41d03_row2_col2" class="data row2 col2" >10</td>
      <td id="T_41d03_row2_col3" class="data row2 col3" >2</td>
      <td id="T_41d03_row2_col4" class="data row2 col4" >0.29 +/- 0.0035</td>
      <td id="T_41d03_row2_col5" class="data row2 col5" >0.29</td>
      <td id="T_41d03_row2_col6" class="data row2 col6" >0.28</td>
      <td id="T_41d03_row2_col7" class="data row2 col7" >0.64</td>
    </tr>
    <tr>
      <th id="T_41d03_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_41d03_row3_col0" class="data row3 col0" >diabetes</td>
      <td id="T_41d03_row3_col1" class="data row3 col1" >768</td>
      <td id="T_41d03_row3_col2" class="data row3 col2" >8</td>
      <td id="T_41d03_row3_col3" class="data row3 col3" >2</td>
      <td id="T_41d03_row3_col4" class="data row3 col4" >0.25 +/- 0.03</td>
      <td id="T_41d03_row3_col5" class="data row3 col5" >0.29</td>
      <td id="T_41d03_row3_col6" class="data row3 col6" >0.25</td>
      <td id="T_41d03_row3_col7" class="data row3 col7" >0.76</td>
    </tr>
    <tr>
      <th id="T_41d03_level0_row4" class="row_heading level0 row4" >4</th>
      <td id="T_41d03_row4_col0" class="data row4 col0" >credit</td>
      <td id="T_41d03_row4_col1" class="data row4 col1" >690</td>
      <td id="T_41d03_row4_col2" class="data row4 col2" >15</td>
      <td id="T_41d03_row4_col3" class="data row4 col3" >2</td>
      <td id="T_41d03_row4_col4" class="data row4 col4" >0.14 +/- 0.034</td>
      <td id="T_41d03_row4_col5" class="data row4 col5" >0.2</td>
      <td id="T_41d03_row4_col6" class="data row4 col6" >0.15</td>
      <td id="T_41d03_row4_col7" class="data row4 col7" >0.95</td>
    </tr>
  </tbody>
</table>

</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r2</span> <span class="o">=</span> <span class="n">runMRC</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="s2">&quot;fourier&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">r2</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Using log loss and fourier feature mapping&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<style type="text/css">
</style>
<table id="T_55a75">
  <caption>Using log loss and fourier feature mapping</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_55a75_level0_col0" class="col_heading level0 col0" >dataset</th>
      <th id="T_55a75_level0_col1" class="col_heading level0 col1" >n_samples</th>
      <th id="T_55a75_level0_col2" class="col_heading level0 col2" >n_attributes</th>
      <th id="T_55a75_level0_col3" class="col_heading level0 col3" >n_classes</th>
      <th id="T_55a75_level0_col4" class="col_heading level0 col4" >error</th>
      <th id="T_55a75_level0_col5" class="col_heading level0 col5" >upper</th>
      <th id="T_55a75_level0_col6" class="col_heading level0 col6" >lower</th>
      <th id="T_55a75_level0_col7" class="col_heading level0 col7" >avg_train_time (s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_55a75_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_55a75_row0_col0" class="data row0 col0" >mammographic</td>
      <td id="T_55a75_row0_col1" class="data row0 col1" >961</td>
      <td id="T_55a75_row0_col2" class="data row0 col2" >5</td>
      <td id="T_55a75_row0_col3" class="data row0 col3" >2</td>
      <td id="T_55a75_row0_col4" class="data row0 col4" >0.18 +/- 0.011</td>
      <td id="T_55a75_row0_col5" class="data row0 col5" >0.54</td>
      <td id="T_55a75_row0_col6" class="data row0 col6" >0.44</td>
      <td id="T_55a75_row0_col7" class="data row0 col7" >2.3</td>
    </tr>
    <tr>
      <th id="T_55a75_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_55a75_row1_col0" class="data row1 col0" >haberman</td>
      <td id="T_55a75_row1_col1" class="data row1 col1" >306</td>
      <td id="T_55a75_row1_col2" class="data row1 col2" >3</td>
      <td id="T_55a75_row1_col3" class="data row1 col3" >2</td>
      <td id="T_55a75_row1_col4" class="data row1 col4" >0.27 +/- 0.016</td>
      <td id="T_55a75_row1_col5" class="data row1 col5" >0.58</td>
      <td id="T_55a75_row1_col6" class="data row1 col6" >0.5</td>
      <td id="T_55a75_row1_col7" class="data row1 col7" >1.1</td>
    </tr>
    <tr>
      <th id="T_55a75_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_55a75_row2_col0" class="data row2 col0" >indian_liver</td>
      <td id="T_55a75_row2_col1" class="data row2 col1" >583</td>
      <td id="T_55a75_row2_col2" class="data row2 col2" >10</td>
      <td id="T_55a75_row2_col3" class="data row2 col3" >2</td>
      <td id="T_55a75_row2_col4" class="data row2 col4" >0.29 +/- 0.0035</td>
      <td id="T_55a75_row2_col5" class="data row2 col5" >0.6</td>
      <td id="T_55a75_row2_col6" class="data row2 col6" >0.59</td>
      <td id="T_55a75_row2_col7" class="data row2 col7" >1.8</td>
    </tr>
    <tr>
      <th id="T_55a75_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_55a75_row3_col0" class="data row3 col0" >diabetes</td>
      <td id="T_55a75_row3_col1" class="data row3 col1" >768</td>
      <td id="T_55a75_row3_col2" class="data row3 col2" >8</td>
      <td id="T_55a75_row3_col3" class="data row3 col3" >2</td>
      <td id="T_55a75_row3_col4" class="data row3 col4" >0.24 +/- 0.027</td>
      <td id="T_55a75_row3_col5" class="data row3 col5" >0.6</td>
      <td id="T_55a75_row3_col6" class="data row3 col6" >0.52</td>
      <td id="T_55a75_row3_col7" class="data row3 col7" >2.7</td>
    </tr>
    <tr>
      <th id="T_55a75_level0_row4" class="row_heading level0 row4" >4</th>
      <td id="T_55a75_row4_col0" class="data row4 col0" >credit</td>
      <td id="T_55a75_row4_col1" class="data row4 col1" >690</td>
      <td id="T_55a75_row4_col2" class="data row4 col2" >15</td>
      <td id="T_55a75_row4_col3" class="data row4 col3" >2</td>
      <td id="T_55a75_row4_col4" class="data row4 col4" >0.14 +/- 0.034</td>
      <td id="T_55a75_row4_col5" class="data row4 col5" >0.5</td>
      <td id="T_55a75_row4_col6" class="data row4 col6" >0.39</td>
      <td id="T_55a75_row4_col7" class="data row4 col7" >2.5</td>
    </tr>
  </tbody>
</table>

</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  10.256 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-1-example-mrc-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/42813cded9d36e10cbda4025957623a0/plot_1_example_mrc.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_1_example_mrc.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/926b8ffbe71d9c44c649c76ac09fddad/plot_1_example_mrc.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_1_example_mrc.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Gallery of examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plot_2_example_cmrc.html" class="btn btn-neutral float-right" title="Example: Use of CMRC with different settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Kartheek Bondugula, Claudia Guerrero, Santiago Mazuelas and Aritz Perez.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>